<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Index</title>
    <link href="/Content/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="/Content/faicon/css/all.min.css" rel="stylesheet" type="text/css" />
    <link href="/Content/ChatBox.css" rel="stylesheet" type="text/css" />

    <script src="/Scripts/jquery-3.2.1.min.js"></script>
    <script src="/Scripts/jquery.signalR-2.4.1.min.js"></script>
    <script src="/signalr/hubs"></script>
    <style>
        body {
            background-color: transparent;
        }
    </style>
</head>
<body>
    <div class="chatbox">
        <div class="head">
            <div>
                    <span>Chat với KienLongBank</span>
                <a href="tel:02862858185">
                    <i class="fa fa-phone" style="color:white;background:#0f848d;padding:5px 7px;margin-left:10px;"></i>
                </a>
            </div>
            <div class="Menu">
                <i class="btnShowChat fa fa-angle-up" style="background-color:#0f848d;padding:4px 7px; float:right"></i>
                
                
            </div>
        </div>
        <div class="body" style="display:none; background-color:#f7f7f7">
            

<div class="error">
    
</div>
<form id="frmFormChat" method="post" action="/WebChat/StartChat" style="font-size:14px;padding: 0.75rem 0.75rem 0 0.75rem;">
    <div class="form-group">
        <input class="form-control" id="FullName" name="FullName" placeholder="Họ và tên" required="required" type="text" value="" />
    </div>
    <div class="form-group">
        <select class="form-control" id="Gender" name="Gender" required="required"><option value="1">Nam</option>
<option value="2">Nữ</option>
</select>
    </div>
    <div class="form-group">
        <input class="form-control" id="Phone" name="Phone" placeholder="Số điện thoại" required="required" type="text" value="" />
    </div>
    <div class="form-group">
        <select class="form-control" id="Address" name="Address" placeholder="Khu vực sinh sống" required="required"><option>An Giang</option>
<option>B&#224; Rịa - Vũng T&#224;u</option>
<option>Bắc Giang</option>
<option>Bắc Kạn</option>
<option>Bạc Li&#234;u</option>
<option>Bắc Ninh</option>
<option>Bến Tre</option>
<option>B&#236;nh Định</option>
<option>B&#236;nh Dương</option>
<option>B&#236;nh Phước</option>
<option>B&#236;nh Thuận</option>
<option>C&#224; Mau</option>
<option>Cao Bằng</option>
<option>Đắk Lắk</option>
<option>Đắk N&#244;ng</option>
<option>Điện Bi&#234;n</option>
<option>Đồng Nai</option>
<option>Đồng Th&#225;p</option>
<option>Gia Lai</option>
<option>H&#224; Giang</option>
<option>H&#224; Nam</option>
<option>H&#224; Tĩnh</option>
<option>Hải Dương</option>
<option>Hậu Giang</option>
<option>H&#242;a B&#236;nh</option>
<option>Hưng Y&#234;n</option>
<option>Kh&#225;nh H&#242;a</option>
<option>Ki&#234;n Giang</option>
<option>Kon Tum</option>
<option>Lai Ch&#226;u</option>
<option>L&#226;m Đồng</option>
<option>Lạng Sơn</option>
<option>L&#224;o Cai</option>
<option>Long An</option>
<option>Nam Định</option>
<option>Nghệ An</option>
<option>Ninh B&#236;nh</option>
<option>Ninh Thuận</option>
<option>Ph&#250; Thọ</option>
<option>Quảng B&#236;nh</option>
<option>Quảng Nam</option>
<option>Quảng Ng&#227;i</option>
<option>Quảng Ninh</option>
<option>Quảng Trị</option>
<option>S&#243;c Trăng</option>
<option>Sơn La</option>
<option>T&#226;y Ninh</option>
<option>Th&#225;i B&#236;nh</option>
<option>Th&#225;i Nguy&#234;n</option>
<option>Thanh H&#243;a</option>
<option>Thừa Thi&#234;n Huế</option>
<option>Tiền Giang</option>
<option>Tr&#224; Vinh</option>
<option>Tuy&#234;n Quang</option>
<option>Vĩnh Long</option>
<option>Vĩnh Ph&#250;c</option>
<option>Y&#234;n B&#225;i</option>
<option>Ph&#250; Y&#234;n</option>
<option>Cần Thơ</option>
<option>Đ&#224; Nẵng</option>
<option>Hải Ph&#242;ng</option>
<option>H&#224; Nội</option>
<option>TP HCM</option>
</select>
    </div>
    <div class="form-group">
        <select class="form-control" id="SupportTypeID" name="SupportTypeID" required="required"><option value="1">Tư vấn</option>
<option value="2">Khiếu nại</option>
<option value="3">G&#243;p &#253;</option>
<option value="4">Hỗ trợ</option>
<option value="5">Kh&#225;c</option>
</select>
    </div>
    <div class="form-group">
        <button class="btn" style="background-color:#0f848d;font-weight:bold;color:white;">BẮT ĐẦU</button>
    </div>
</form>
<script>
    $(document).ready(function () {
        $(".btnMenu").addClass("bar-hide");

        var heightHead = $(".chatbox .head").innerHeight();
        var heighticonShowChat = $(".chatbox .iconShowChat").innerHeight();
        var heightBody = $(".chatbox .body").innerHeight();

        //check ads
        $.ajax({
            url: '/WebChat/PopupADS',
            method: "POST",
            success: function (result) {
                if (result != "") {
                    $.cookie("showChat", 1);
                    parent.postMessage("OPEN|" + (heightHead + heightBody + 2) + "", "*");
                    $(".chatbox .head .btnShowChat").removeClass("fa-angle-up").addClass("fa-angle-down");
                    $(".chatbox .head").show();
                    $(".chatbox .body").show();
                    $(".chatbox .iconShowChat").hide();
                    $("#modal .modal-content").html(result);
                    $("#modal").modal("show");
                }
            }
        });
    });
</script>

        </div>
        <div class="iconShowChat" style="width:50px;height:50px">
            <img src="/Images/iconChat.jpg" style="width:50px;height:50px" />
        </div>
    </div>
    <div class="modal" id="modal">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
            </div>
        </div>
    </div>
    <script src="/Scripts/jquery.cookie.js"></script>
    <script src="/Scripts/popper.min.js"></script>
    <script src="/Scripts/bootstrap.min.js"></script>
    <script>
        $(document).ready(function () {
            var heightHead = $(".chatbox .head").innerHeight();
            var heighticonShowChat = $(".chatbox .iconShowChat").innerHeight();
            var heightBody = $(".chatbox .body").innerHeight();
            if ($.cookie("showChat") == 1) {
                parent.postMessage("OPEN|" + (heightHead + heightBody + 2) + "", "*");
                $(".chatbox .head .btnShowChat").removeClass("fa-angle-up").addClass("fa-angle-down");
                $(".chatbox .head").show();
                $(".chatbox .body").show();
                $(".chatbox .iconShowChat").hide();
            }
            else {
                parent.postMessage("CLOSE|" + heighticonShowChat + "", "*");
                $(".chatbox .head .btnShowChat").removeClass("fa-angle-down").addClass("fa-angle-up");
                $(".chatbox .head").hide();
                $(".chatbox .body").hide();
                $(".chatbox .iconShowChat").show();
            }

            $("#timelineChatBox").animate({ scrollTop: $("#timelineChatBox").prop("scrollHeight") }, 500);

            $(".chatbox .head .btnShowChat").on("click", function () {
                var ckShowChat = $.cookie("showChat");
                if (ckShowChat != null) {
                    if (ckShowChat == 0) {
                        $.cookie("showChat", 1);
                        parent.postMessage("OPEN|" + (heightHead + heightBody + 2) + "", "*");
                        $(this).removeClass("fa-angle-up").addClass("fa-angle-down");
                        $(".chatbox .head").show();
                        $(".chatbox .body").show();
                    }
                    else {
                        $.cookie("showChat", 0);
                        parent.postMessage("CLOSE|" + heighticonShowChat + "", "*");
                        $(this).removeClass("fa-angle-down").addClass("fa-angle-up");
                        $(".chatbox .head").hide();
                        $(".chatbox .body").hide();
                        $(".chatbox .iconShowChat").show();
                    }
                }
                else {
                    $.cookie("showChat", 1);
                    parent.postMessage("OPEN|" + (heightHead + heightBody + 2) + "", "*");
                    $(this).removeClass("fa-angle-up").addClass("fa-angle-down");
                    $(".chatbox .head").show();
                    $(".chatbox .body").show();
                    $(".chatbox .iconShowChat").hide();
                }
            });

            $(".chatbox .iconShowChat").on("click", function () {
                var ckShowChat = $.cookie("showChat");
                if (ckShowChat != null) {
                    if (ckShowChat == 0) {
                        $.cookie("showChat", 1);
                        parent.postMessage("OPEN|" + (heightHead + heightBody + 2) + "", "*");
                        $(".chatbox .head .btnShowChat").removeClass("fa-angle-up").addClass("fa-angle-down");
                        $(".chatbox .head").show();
                        $(".chatbox .body").show();
                        $(".chatbox .iconShowChat").hide();
                        SetMessageStatusOpenWindow();
                    }
                    else {
                        $.cookie("showChat", 0);
                        parent.postMessage("CLOSE|" + heightHead + "", "*");
                        $(this).removeClass("fa-angle-down").addClass("fa-angle-up");
                        $(".chatbox .head").hide();
                        $(".chatbox .body").hide();
                    }
                }
                else {
                    $.cookie("showChat", 1);
                    parent.postMessage("OPEN|" + (heightHead + heightBody + 2) + "", "*");
                    $(".chatbox .head .btnShowChat").removeClass("fa-angle-up").addClass("fa-angle-down");
                    $(".chatbox .head").show();
                    $(".chatbox .body").show();
                    $(".chatbox .iconShowChat").hide();
                    SetMessageStatusOpenWindow();
                }
            });

            $(".btnShowQA").on("click", function () {
                parent.postMessage("OPEN|" + (heightHead + heightBody + 2) + "", "*");
                $(".chatbox .head .btnShowChat").removeClass("fa-angle-up").addClass("fa-angle-down");
                $(".chatbox .body").show();
            });

            $("#closesupport").on("click", function () {
                $.ajax({
                    url: '/WebChat/CloseSupport',
                    method: "POST",
                    success: function (result) {
                        location.reload();
                    }
                });
            });

            $("#response").on("click", function () {
                $.ajax({
                    url: '/WebChat/ResponseService',
                    method: "POST",
                    success: function (result) {
                        $("#modal .modal-content").html(result);
                        $("#modal").modal("show");
                    }
                });
            });

            $("#closesupportandresponse").on("click", function () {
                $.ajax({
                    url: '/WebChat/ResponseService',
                    method: "POST",
                    data: {
                        bCloseSupport: true
                    },
                    success: function (result) {
                        $("#modal .modal-content").html(result);
                        $("#modal").modal("show");
                    }
                });
            });

            $(".closesupport").on("click", function () {
                $.ajax({
                    url: '/WebChat/ResponseService',
                    method: "POST",
                    data: {
                        bCloseSupport: true
                    },
                    success: function (result) {
                        $("#modal .modal-content").html(result);
                        $("#modal").modal("show");
                    }
                });
            });

            function SetMessageStatusOpenWindow() {
            $.ajax({
                url: '/WebChat/SetMessageStatusOpenWindow',
                method: "POST"
            });
        }
        });
    </script>
</body>
</html>

<style>
    .bar-hide{
        display:none;
    }
</style>
